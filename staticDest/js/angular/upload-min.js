"use strict";angular.module("uploadTrack",["ngRoute"]).controller("uploadTrack",function(e,a,r){var o=document.querySelector("#file"),t=document.querySelector("#image"),n=document.querySelector("#uploadForm"),u=(document.querySelector("#progress"),document.querySelector(".error")),l=document.querySelector("#title");o.addEventListener("change",function(e){var a=e.target.files[0].name;a=(a=(a=a.split(".")[0]).replace(/\W/gim,"")).replace(/ /gim,"-"),l.value=a}),n.onsubmit=function(e){if(e.preventDefault(),u.innerHTML="We are uploading your track now",o.files[0]){var n=o.files[0],i=new FormData;ajax.open("POST","/api/upload"),i.append("audio",n),i.append("title",l.value),i.append("image",t.files[0]),ajax.setRequestHeader("token",$token),ajax.send(i),ajax.onload=function(){if(4===ajax.readyState&&200===ajax.status){var e=JSON.parse(ajax.response);e.error?u.innerHTML=e.msg:(a.url("/home"),r({method:"GET",url:"/home"}))}}}}});